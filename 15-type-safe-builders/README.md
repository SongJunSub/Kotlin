# 15. 타입 안전 빌더 (Type-Safe Builders / DSL)

타입 안전 빌더는 코틀린의 유연한 문법을 활용하여 특정 구조(예: HTML, JSON, UI 레이아웃)를 선언적으로 생성하기 위한 DSL(Domain-Specific Language, 도메인 특화 언어)을 만드는 디자인 패턴입니다. 코드가 마치 설정 파일처럼 보이며, 컴파일 시점에 타입 오류를 잡아낼 수 있어 매우 안정적입니다.

## 핵심 원리

타입 안전 빌더는 다음 세 가지 코틀린 기능을 조합하여 만들어집니다.

1.  **고차 함수 (Higher-Order Functions)**: 다른 함수를 인자로 받는 함수.
2.  **수신 객체가 있는 람다 (Lambdas with Receiver)**: 람다 내부에서 특정 객체의 컨텍스트를 `this`로 사용할 수 있게 하는 기능입니다. 이를 통해 중첩된 구조를 간결하게 표현할 수 있습니다.
3.  **확장 함수 (Extension Functions)**: 기존 클래스에 새로운 함수를 추가하여 빌더의 API를 확장합니다.

## 왜 유용한가?

- **가독성**: 코드가 계층 구조를 그대로 반영하여 이해하기 쉽습니다.
- **타입 안정성**: 잘못된 위치에 잘못된 요소를 추가하는 등의 실수를 컴파일러가 미리 막아줍니다.
- **유연성**: 코틀린 코드로 작성되므로, 일반적인 프로그래밍 로직(변수, 반복문, 조건문 등)을 DSL 내에서 자유롭게 사용할 수 있습니다.

## 대표적인 사용 사례

- **Gradle Kotlin DSL**: `build.gradle.kts`에서 빌드 스크립트를 작성할 때 사용됩니다.
- **Jetpack Compose**: 안드로이드 UI를 선언적으로 구성하는 데 핵심적인 역할을 합니다.
- **Ktor**: 웹 애플리케이션의 라우팅 구조를 정의할 때 사용됩니다.

아래 `TypeSafeBuilder.kt` 파일에서는 간단한 HTML 테이블을 만드는 DSL 예제를 확인할 수 있습니다.
